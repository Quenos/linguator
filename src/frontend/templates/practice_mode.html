<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Practice Mode - Linguator</title>
    <!-- Removed HTMX script -->
    <!-- Basic Styling (Optional) -->
    <style>
        body { font-family: sans-serif; padding: 20px; }
        #practice-area { margin-top: 20px; border: 1px solid #ccc; padding: 15px; min-height: 150px; }
        #flashcard { padding: 10px; border: 1px dashed #eee; margin-top: 10px; }
    </style>
</head>
<body>

<h1>Practice Mode</h1>

<!-- Button to start the practice session -->
<button id="start-practice-btn">
    Start Practice (10 words)
</button>

<!-- Area where the practice questions/feedback will be loaded -->
<div id="practice-area">
    <p>Click "Start Practice" to begin.</p>
</div>

<script>
    // Store the fetched word pairs for the session
    let currentPracticePairs = [];
    let currentQuestionIndex = -1; // Initialize to -1, will be 0 for the first question

    const startButton = document.getElementById('start-practice-btn');
    const practiceArea = document.getElementById('practice-area');

    startButton.addEventListener('click', async () => {
        console.log('Start Practice clicked');
        practiceArea.innerHTML = '<p>Loading questions...</p>'; // Provide immediate feedback
        try {
            const response = await fetch('/word-pairs/?limit=10'); // Fetch 10 pairs
            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }
            currentPracticePairs = await response.json(); // Store the pairs
            console.log('Fetched pairs:', currentPracticePairs);

            if (currentPracticePairs && currentPracticePairs.length > 0) {
                currentQuestionIndex = 0; // Set index to the first question
                displayQuestion(currentQuestionIndex);
            } else {
                practiceArea.innerHTML = '<p>No word pairs found to practice.</p>';
            }
        } catch (error) {
            console.error('Error fetching practice pairs:', error);
            practiceArea.innerHTML = '<p>Error loading questions. Please try again.</p>';
        }
    });

    function displayQuestion(index) {
        if (index < 0 || index >= currentPracticePairs.length) {
            practiceArea.innerHTML = '<p>Invalid question index.</p>'; // Should not happen in normal flow
            return;
        }

        const wordPair = currentPracticePairs[index];
        // Generate HTML for the flashcard (only the source word initially)
        practiceArea.innerHTML = `
            <div id="flashcard">
                <h2>Flashcard (${index + 1} / ${currentPracticePairs.length})</h2>
                <p><strong>Source Word:</strong> ${escapeHTML(wordPair.source_word)}</p>
                
                <!-- Placeholder for answer reveal mechanism (Ticket 3) -->
                <button>Show Answer</button> 
                
                <!-- Placeholder for navigation (Ticket 4) -->
                <!-- <button>Next</button> -->
            </div>
        `;
        console.log(`Displayed question ${index + 1}:`, wordPair);
    }

    // Basic HTML escaping function to prevent XSS
    function escapeHTML(str) {
        const div = document.createElement('div');
        div.textContent = str;
        return div.innerHTML;
    }

</script>

</body>
</html> 